(function(e){function t(t){for(var s,a,r=t[0],l=t[1],c=t[2],d=0,p=[];d<r.length;d++)a=r[d],o[a]&&p.push(o[a][0]),o[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(s=!1)}s&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},o={app:0},i=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/billshare/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"269d":function(e,t,n){},"342b":function(e,t,n){"use strict";var s=n("ac4f"),o=n.n(s);o.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],a={name:"app",mounted:function(){this.init()},methods:{init:function(){}}},r=a,l=n("2877"),c=Object(l["a"])(r,o,i,!1,null,null,null),u=c.exports,d=n("59ca"),p=n.n(d),m=(n("ea7b"),n("8c4f")),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("div",{staticClass:"tb"},[n("div",{staticClass:"tbT"},[e.date?n("div",{staticClass:"pT",domProps:{textContent:e._s(e.getMonth(e.date.getMonth()-1)+" "+e.date.getFullYear()+" Expense")}}):e._e()]),n("div",{staticClass:"tbB"},[n("div",{staticClass:"pN"},[n("div",[e._v("Hi "+e._s(e.currentUser.displayName))]),n("div",{staticClass:"lo",on:{click:e.logout}},[e._v("Logout")])])])]),n("div",{staticClass:"cW"},[n("Person",{staticClass:"uW",attrs:{personCollection:e.personCollection}}),n("Expense",{staticClass:"eW",attrs:{personCollection:e.personCollection,expenseCollection:e.expenseCollection}})],1)])},v=[],f=(n("ac6a"),n("a481"),n("cebc")),g=n("2f62"),C=(n("e71f"),{firebaseConfig:{apiKey:"AIzaSyB1gTLWPHWOHCZFhs1yGuouPZ_F9anANLw",authDomain:"billshare-4f2ac.firebaseapp.com",databaseURL:"https://billshare-4f2ac.firebaseio.com",projectId:"billshare-4f2ac",storageBucket:"billshare-4f2ac.appspot.com",messagingSenderId:"810948359815"},adminUid:"tMfUwcCyAlVEBjRT6oUVrRIjQ8v1"});p.a.initializeApp(C.firebaseConfig);var b=p.a.firestore(),P=p.a.auth(),_=P.currentUser,x=b.collection("persons"),w=b.collection("expenses"),E={db:b,auth:P,currentUser:_,personCollection:x,expenseCollection:w},y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"uW"},[0==e.personCollection.length?n("div",[e._v("No Persons Added")]):e._e(),e._l(e.personCollection,function(t){return n("div",{key:t.id},[n("div",{domProps:{textContent:e._s(t.name)}}),t.modified?n("div",[n("div",{domProps:{textContent:e._s(t.modify.toPay)}}),e._v("\n      (\n      "),n("div",{domProps:{textContent:e._s(t.toPay+" "+("add"===t.modify.mode?"+":"-")+" "+t.modify.change)}}),e._v("\n      )\n      "),t.change?n("div",{domProps:{textContent:e._s(t.change)}}):e._e()]):e._e(),t.modified?e._e():n("div",{staticClass:"pa",domProps:{textContent:e._s(t.toPay)}}),e.isAdmin?n("div",{on:{click:function(n){return e.deletePeople(t.id)}}},[e._v("×")]):e._e()])}),e.isAdmin?n("NewPerson"):e._e()],2)},A=[],O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isAdmin?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),n("button",{on:{click:e.addPerson}},[e._v("Add Person")])]):e._e()},j=[],N=(n("7f7f"),{name:"PersonEditor",computed:Object(f["a"])({},Object(g["b"])(["isAdmin"])),data:function(){return{name:"",photo:null}},methods:{addPerson:function(){var e=this;if(this.name&&this.name.trim().length>1){var t={createdOn:new Date,name:this.name,photo:this.photo};E.personCollection.add(t).then(function(n){t.id=n.id,e.$parent.init()}).catch(function(e){console.log(e)})}}}}),$=N,S=Object(l["a"])($,O,j,!1,null,null,null),U=S.exports,k={name:"Person",components:{NewPerson:U},computed:Object(f["a"])({},Object(g["b"])(["isAdmin"])),props:["personCollection"]},B=k,I=Object(l["a"])(B,y,A,!1,null,null,null),T=I.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[e._v("Bill Listed")]),e._v("\n  "+e._s(e.expenseCollection)+"\n  "),n("div",{on:{click:function(t){e.show.editor=!0}}},[e._v("+")]),e.isAdmin&&e.show.editor?n("NewExpense",{attrs:{personCollection:e.personCollection}}):e._e()],1)},D=[],L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isAdmin?n("div",{staticClass:"neO"},[n("div",{staticClass:"overB",on:{click:function(t){return t.preventDefault(),e.goBack()}}}),n("div",{staticClass:"neW"},[n("div",{staticClass:"neT"},[e._v("New Expense")]),n("div",{staticClass:"butClose",on:{click:e.goBack}},[e._v("Cancel")]),n("div",{staticClass:"neIW"},[n("div",{staticClass:"neSeB"},[n("div",{staticClass:"neSeT"},[e._v("Bill Information")]),n("div",{staticClass:"neIr"},[n("span",{staticClass:"iL mdtry"},[e._v("Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"Expense Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),n("div",{staticClass:"neIr"},[n("span",{staticClass:"iL mdtry"},[e._v("Amount")]),n("span",{staticClass:"currency"},[e._v("₹")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.cost,expression:"cost",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Expense Amount"},domProps:{value:e.cost},on:{input:function(t){t.target.composing||(e.cost=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),n("div",{staticClass:"neIr"},[n("span",{staticClass:"iL"},[e._v("Date")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.date,expression:"date"}],attrs:{type:"date",placeholder:"Expense Date"},domProps:{value:e.date},on:{input:function(t){t.target.composing||(e.date=t.target.value)}}})])]),n("div",{staticClass:"exPc"},[n("div",{staticClass:"exPcL"},[n("div",{staticClass:"exPcT"},[e._v("Billed Persons")]),e._l(e.selectedPersons,function(t,s){return n("div",{key:t.id,staticClass:"exPcP"},[e._m(0,!0),n("div",{staticClass:"pName",domProps:{textContent:e._s(t.name)}}),n("span",{staticClass:"currency"},[e._v("₹")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cost,expression:"person.cost",modifiers:{number:!0}}],attrs:{type:"number",disabled:"disabled"},domProps:{value:t.cost},on:{input:function(n){n.target.composing||e.$set(t,"cost",e._n(n.target.value))},blur:function(t){return e.$forceUpdate()}}}),n("div",{staticClass:"but",on:{click:function(n){return e.removePerson(t,s)}}},[e._v("-")])])})],2),n("div",{staticClass:"exPcR"},[n("div",{staticClass:"exPcT"},[e._v("Available Persons")]),e._m(1),e._l(e.availablePersons,function(t){return n("div",{key:t.id,staticClass:"exPcP"},[e._m(2,!0),n("div",{staticClass:"pName",domProps:{textContent:e._s(t.name)}}),n("span",{staticClass:"currency"},[e._v("₹")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.cost,expression:"person.cost",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.cost},on:{input:function(n){n.target.composing||e.$set(t,"cost",e._n(n.target.value))},blur:function(t){return e.$forceUpdate()}}}),n("div",{staticClass:"but",on:{click:function(n){return e.addPerson(t)}}},[e._v("+")])])})],2)])]),n("div",{staticClass:"butSB",on:{click:e.previewExpense}},[e._v("Preview Expense")]),n("div",{staticClass:"butPB",on:{click:e.addExpense}},[e._v("Add Expense")])]),e.error?n("div",{staticClass:"err",domProps:{textContent:e._s(e.error)}}):e._e()]):e._e()},W=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pCont"},[s("img",{staticClass:"pPic",attrs:{src:n("c824")}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"neHt"},[n("span",[e._v("? To autocalculate bill set '0' as cost")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pCont"},[s("img",{staticClass:"pPic",attrs:{src:n("c824")}})])}],V=(n("28a5"),{name:"ExpenseEditor",computed:Object(f["a"])({},Object(g["b"])(["isAdmin"])),props:["personCollection"],data:function(){return{name:"",cost:null,costValidate:!1,date:null,persons:{},selectedPersons:[],availablePersons:[],error:null}},mounted:function(){this.initPersons()},methods:{goBack:function(){this.$parent.show.editor=!1},initExpense:function(){this.availablePersons=[],this.selectedPersons=[],this.persons={},this.costValidate=!1,this.name&&0==this.name.trim().length&&(this.name=""),this.date=null},initPersons:function(){if(this.initExpense(),this.personCollection)for(var e=0;e<this.personCollection.length;e++){var t=this.personCollection[e];this.availablePersons.push({id:t.id,name:t.name,cost:0})}},addExpense:function(){var e=this;if(this.name&&this.name.trim().length>0&&this.cost>0&&this.costValidate){var t={createdOn:new Date,name:this.name,cost:this.cost,date:this.date?new Date(this.date):null,persons:this.persons,id:"TEMP"};E.expenseCollection.add(t).then(function(n){for(var s in t.id=n.id,t.persons){for(var o=0;o<e.personCollection.length;o++)if(s===e.personCollection[o].id){e.personCollection[o].expenses[t.id]={cost:t.persons[s].cost,id:t.id,date:new Date,name:t.name};var i=0;for(var a in e.personCollection[o].expenses)i+=e.personCollection[o].expenses[a].cost;E.personCollection.doc(s).set({expenses:e.personCollection[o].expenses,toPay:i,paid:!1},{merge:!0}).then(function(){console.log("Person successfully updated!")}).catch(function(e){console.error("Error writing document: ",e)})}e.$parent.expenseAdded()}}).catch(function(e){console.log(e)})}else this.costValidate?this.showError("Invalid Bill"):this.showError("Billed Person Amount Invalid")},previewExpense:function(){if(this.name&&this.name.trim().length>0&&this.cost>0&&this.costValidate){var e={createdOn:new Date,name:this.name,cost:this.cost,date:this.date?new Date(this.date):null,persons:this.persons};for(var t in e.persons)for(var n=0;n<this.personCollection.length;n++)t===this.personCollection[n].id&&(this.personCollection[n].expenses["<TEMP>"]={cost:e.persons[t].cost,id:"<TEMP>"},this.personCollection[n].modify={mode:"add",toPay:this.personCollection[n].toPay+e.persons[t].cost,change:e.persons[t].cost},this.personCollection[n].modified=!0)}else this.costValidate?this.showError("Invalid Bill"):this.showError("Billed Person Amount Invalid")},showError:function(e){this.error=e,setTimeout(this.hideError,2e3)},hideError:function(){this.error=null},addPerson:function(e,t){this.persons[e.id]||(e.cost<this.cost?(this.persons[e.id]=e.name,this.selectedPersons.push({id:e.id,name:e.name,cost:e.cost,omitSplit:e.cost>0}),this.availablePersons.splice(t,1),this.recalculateSplit()):this.showError("Individual Cost must be less than total bill cost to share bill"))},recalculateSplit:function(){var e=0,t=0;this.selectedPersons.forEach(function(n){n.omitSplit?t+=n.cost:e++});for(var n=(this.cost-t)/e,s=0,o=0;o<this.selectedPersons.length;o++)this.selectedPersons[o].omitSplit||(this.selectedPersons[o].cost=n),s+=this.selectedPersons[o].cost,this.persons[this.selectedPersons[o].id]=this.selectedPersons[o];this.costValidate=s===this.cost},removePerson:function(e,t){this.persons[e.id]&&(delete this.persons[e.id],this.availablePersons.push({id:e.id,name:e.name}),this.selectedPersons.splice(t,1),this.recalculateSplit())},costReset:function(e){this.split.amount=e}},watch:{personCollection:function(){this.initPersons()},cost:function(){this.initPersons()}}}),H=V,J=Object(l["a"])(H,L,W,!1,null,null,null),R=J.exports,F={name:"ExpenseListing",computed:Object(f["a"])({},Object(g["b"])(["isAdmin"])),components:{NewExpense:R},data:function(){return{show:{editor:!1}}},props:["personCollection","expenseCollection"],methods:{expenseAdded:function(){this.$parent.init()}}},G=F,q=Object(l["a"])(G,M,D,!1,null,null,null),z=q.exports,Z={name:"home",computed:Object(f["a"])({},Object(g["b"])(["currentUser","isAdmin"])),components:{Person:T,Expense:z},mounted:function(){this.init()},data:function(){return{date:null,personCollection:[],expenseCollection:[]}},methods:{logout:function(){var e=this;E.auth.signOut().then(function(){e.$store.commit("setCurrentUser",null),e.$router.replace("login")})},init:function(){var e=this;this.date=new Date,E.personCollection.orderBy("name","asc").onSnapshot(function(t){var n=[];t.forEach(function(e){var t=e.data();t.id=e.id,t.modified=!1,n.push(t)}),e.personCollection=n}),E.expenseCollection.orderBy("createdOn","desc").onSnapshot(function(t){var n=[];t.forEach(function(e){var t=e.data();t.id=e.id,n.push(t)}),e.expenseCollection=n})},deletePeople:function(e){E.personCollection.doc(e).delete().then(function(){alert("Person successfully deleted!")}).catch(function(e){console.error("Error removing Person: ",e)})},getMonth:function(e){var t=["Jan","Feb","Mar","Apr","May","Jue","Jul","Aug","Sept","Oct","Nov","Dec"];return-1===e&&(e=t.length-1),t[e]}}},K=Z,Q=Object(l["a"])(K,h,v,!1,null,null,null),Y=Q.exports,X=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login"},[s("img",{attrs:{src:n("cf05")}}),s("h3",[e._v("Sign In")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"text",placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("br"),s("button",{on:{click:e.login}},[e._v("Sign In")]),s("button",{on:{click:e.loginAsGuest}},[e._v("Sign In As Guest")])])},ee=[],te={name:"login",data:function(){return{email:"",password:""}},methods:{login:function(){var e=this;p.a.auth().signInWithEmailAndPassword(this.email,this.password).then(function(t){e.$router.replace("home"),e.$store.commit("setCurrentUser",t)},function(e){alert("Oops. "+e.message)})},loginAsGuest:function(){var e=this;p.a.auth().signInWithEmailAndPassword("guest@domain.com","guest@123").then(function(){e.$router.replace("home")},function(){p.a.auth().createUserWithEmailAndPassword("guest@domain.com","guest@123").then(function(){e.$router.replace("home")},function(e){alert("Oops. "+e.message)})})}}},ne=te,se=(n("342b"),Object(l["a"])(ne,X,ee,!1,null,"7f2fbc5e",null)),oe=se.exports,ie=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sign-up"},[s("img",{attrs:{src:n("cf05")}}),s("p",[e._v("Let's create a new account !")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"text",placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("br"),s("button",{on:{click:e.signUp}},[e._v("Sign Up")]),s("span",[e._v("or go back to "),s("router-link",{attrs:{to:"/login"}},[e._v("login")]),e._v(".")],1)])},ae=[],re={name:"signUp",data:function(){return{email:"",password:"",name:""}},methods:{signUp:function(){var e=this;p.a.auth().createUserWithEmailAndPassword(this.email,this.password).then(function(t){t.updateProfile({displayName:e.name}),e.$router.replace("home")},function(e){alert("Oops. "+e.message)})}}},le=re,ce=(n("b526"),Object(l["a"])(le,ie,ae,!1,null,"1a75f273",null)),ue=ce.exports;s["a"].use(m["a"]);var de=new m["a"]({routes:[{path:"*",redirect:"/login"},{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:oe},{path:"/sign-up",name:"SignUp",component:ue},{path:"/home",name:"Home",component:Y,meta:{requiresAuth:!0}}]});de.beforeEach(function(e,t,n){var s=p.a.auth().currentUser,o=e.matched.some(function(e){return e.meta.requiresAuth});o&&!s?n("login"):!o&&s?n("home"):n()});var pe=de;s["a"].use(g["a"]);var me=new g["a"].Store({state:{currentUser:null,isAdmin:!1},mutations:{setCurrentUser:function(e,t){e.currentUser=t,e.isAdmin=t&&t.uid===C.adminUid}},actions:{}});E.auth.onAuthStateChanged(function(e){e&&me.commit("setCurrentUser",e)});var he=me;s["a"].config.productionTip=!1;var ve="";E.auth.onAuthStateChanged(function(){ve||(ve=new s["a"]({router:pe,store:he,render:function(e){return e(u)}}).$mount("#app"))})},ac4f:function(e,t,n){},b526:function(e,t,n){"use strict";var s=n("269d"),o=n.n(s);o.a},c824:function(e,t,n){e.exports=n.p+"img/guest.svg"},cf05:function(e,t,n){e.exports=n.p+"img/logo.png"}});